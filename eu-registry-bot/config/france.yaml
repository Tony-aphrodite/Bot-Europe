# France Portal Configuration

portal:
  name: "France - Service-Public.fr"
  base_url: "https://www.service-public.gouv.fr"
  enterprise_url: "https://entreprendre.service-public.gouv.fr"
  forms_url: "https://www.formulaires.service-public.gouv.fr"
  language: "fr"

authentication:
  # Authentication methods supported
  methods:
    - certificate  # Electronic certificate (eIDAS)
    - franceconnect  # FranceConnect (OAuth-based)
    - franceconnect_plus  # Enhanced authentication

  # Recommended for automation
  preferred_method: "certificate"

  # Certificate requirements
  certificate:
    type: "eidas"  # eIDAS compliant certificate
    # Qualified electronic signature required for some procedures

endpoints:
  login: "/connexion"
  services: "/particuliers/vosdroits"
  enterprise_services: "/vosdroits"

forms:
  # Public road installation permit - Cerfa 14023*01
  installation_voie_publique:
    name: "Permission de voirie / Permis de stationnement"
    cerfa_number: "14023*01"
    url: "/vosdroits/R17000"

    # Target authority depends on location
    authorities:
      commune: "Mairie"
      metropolitaine: "EPCI"
      departementale: "Services du département"
      nationale: "Direction interdépartementale des routes (Dir)"

    fields:
      - name: "civilite"
        type: "select"
        required: true
        options: ["M.", "Mme"]
        description: "Title"

      - name: "nom"
        type: "text"
        required: true
        description: "Last name"

      - name: "prenom"
        type: "text"
        required: true
        description: "First name"

      - name: "adresse"
        type: "text"
        required: true
        description: "Address"

      - name: "code_postal"
        type: "text"
        required: true
        description: "Postal code"

      - name: "commune"
        type: "text"
        required: true
        description: "City"

      - name: "email"
        type: "email"
        required: true
        description: "Email address"

      - name: "telephone"
        type: "text"
        required: false
        description: "Phone number"

      - name: "siret"
        type: "text"
        required: false
        description: "SIRET number (for businesses)"

      - name: "objet_demande"
        type: "textarea"
        required: true
        description: "Purpose of request"

      - name: "lieu_installation"
        type: "text"
        required: true
        description: "Installation location"

      - name: "date_debut"
        type: "date"
        required: true
        description: "Start date"

      - name: "date_fin"
        type: "date"
        required: false
        description: "End date"

      - name: "superficie"
        type: "text"
        required: false
        description: "Surface area (m²)"

    # Supported file formats for all attachments
    # Based on Service-Public.fr specifications
    supported_formats:
      documents: ["pdf", "doc", "docx", "rtf", "odt", "txt", "xps"]
      spreadsheets: ["xls", "xlsx", "ods"]
      presentations: ["ppt", "pptx", "odp"]
      images: ["jpg", "jpeg", "png", "odg"]
      archives: ["rar", "zip"]

    max_file_size_mb: 10
    max_total_size_mb: 50

    attachments:
      - name: "piece_identite"
        required: true
        formats: ["pdf", "jpg", "jpeg", "png", "doc", "docx"]
        max_size_mb: 5
        description: "Identity document"

      - name: "plan_situation"
        required: true
        formats: ["pdf", "doc", "docx", "jpg", "png"]
        max_size_mb: 10
        description: "Location/situation plan"

      - name: "plan_installation"
        required: true
        formats: ["pdf", "doc", "docx", "jpg", "png"]
        max_size_mb: 10
        description: "Installation plan"

      - name: "document_complementaire"
        required: false
        formats: ["pdf", "doc", "docx", "xls", "xlsx", "jpg", "png", "rtf", "odt"]
        max_size_mb: 10
        description: "Additional supporting documents"

selectors:
  # CSS/XPath selectors for automation - Service-Public.fr / Entreprendre
  # Updated from actual portal analysis

  # Authentication (FranceConnect)
  login_button: "#switch-profil-btn, .fr-btn--login"
  franceconnect_button: ".fr-connect, #franceconnect-button"
  profile_modal: "#fr-modal-switch-profil-1"
  confirm_switch: "#groupBtn-confirm-switch-profil-1"
  close_modal: "#groupBtn-close-modal-switch-profil-1, .fr-modal__close"

  # Language
  language_selector: "#langue"
  language_french: "#language-fr"

  # Cerfa form (14023)
  cerfa_form_link: "a[href*='cerfa_14023.do']"
  form_container: ".fr-container"

  # Form inputs
  location_input: "input[name*='commune'], #commune-input"
  location_autocomplete: ".autocomplete-results, .fr-menu__list"

  # Navigation
  tabs_container: ".fr-tabs"
  tab_buttons: ".fr-tabs__list button"
  tab_panels: ".fr-tabs__panel"

  # Actions
  submit_button: "button[type='submit'], .fr-btn--submit, #envoyer"
  download_form: "a[href*='formulaires.service-public.gouv.fr']"

  # Status messages (DSFR - Design System FR)
  success_message: ".fr-alert--success, .fr-message--success"
  error_message: ".fr-alert--error, .fr-message--error"
  warning_message: ".fr-alert--warning"
  info_message: ".fr-alert--info"

  # Receipt
  receipt_download: ".telecharger-recepisse, a[href*='recepisse']"

  # Waits (in seconds)
  page_load_timeout: 30
  element_timeout: 10
